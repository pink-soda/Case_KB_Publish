邮件主题：回复: [案例号: CAS-10487-P6B5V7 ] % |P2|ICBC|工行用户杨金妹反馈安装edge浏览器失败问题 % 初次响应 CMIT:0001872

====第1封邮件====

发件人：Wei Liang
发送时间：2023-12-14 16:17:29.644000+00:00
邮件内容:
许先生 您好：
感谢您的电话接听。
根据您提供的信息，我谨在此阐述我们双方针对这个问题所涉及范围界定：
问题定义:
工行反馈用户杨金妹的设备离线安装edge浏览器失败，需要协助排查。
问题范围:
我们将协助您分析处理上述问题，并对定义的问题给予最大的技术支持。
如果能及时解决问题，或问题属于产品设计的行为，或问题涉及到三方，我们将考虑关闭案例。如果存在多个问题，则我们考虑拆分案例进行分析。
接下来，我们将开始合作解决这个问题。如果您对以上的问题范围界定有任何异议，请尽快告知。如果您有其他任何疑问。也欢迎随时与我联系。
当前收集的系统日志，可以看到安装edge浏览器失败，提示需要更新系统补丁并重启后，再次安装edge浏览器。
查看系统的PatchLevel版本，显示为1，表明此设备未安装过系统更新补丁。
查看系统补丁安装日志，发现安装2023年11月更新补丁KB5032196失败，报错代码为0x80070490。
发现有提示系统组件存储损坏的警告。
查看对应的cbs日志，提示存储损坏，manifest文件丢失。
最终报80070490-ERROR_NOT_FOUND 错误。
下一步建议：
edge浏览器安装包会检查操作系统版本，如果不符合安装要求，会提示先安装操作系统更新补丁。可以按照以下操作添加注册表，尝试跳过系统版本检查，安装edge浏览器。
1）以管理员权限打开cmd命令行，通过以下命令添加Allowsxs注册表键值。
reg add HKLM\SOFTWARE\Policies\Microsoft\EdgeUpdate /v Allowsxs /t REG_DWORD /d 1 /f
2）再次测试是否可以正常离线安装edge浏览器。
针对系统组件存储库损坏导致更新补丁KB5032196安装失败的问题，请尝试以下操作修复系统组件。
1）找一台成功安装了KB5032196的设备，将C:\Windows共享。
2）确保可以通过\\xxx.xxx.xxx.xxx\windows的方式访问到Windows <file://xxx.xxx.xxx.xxx/windows的方式访问到Windows> 源，以管理员权限打开cmd命令行，运行如下命令尝试修复： 
Dism /Online /Cleanup-Image /RestoreHealth /Source:\\xxx.xxx.xxx.xxx\windows /LimitAccess  （\\xxx.xxx.xxx.xxx\windows指共享访问地址 <file://xxx.xxx.xxx.xxx/windows指共享访问地址> ）
提示：
运行dism命令修复过程中出现0x800f081f属于正常报错。
3）尝试再次安装KB5032196补丁，如果还是安装失败，建议重新安装对应的操作系统或者升级当前的操作系统到V2022-L版本。

====第2封邮件====

发件人：Wei Liang
发送时间：2023-12-18 14:51:54.814000+00:00
邮件内容:
许先生 您好：
感谢您的电话接听。
麻烦您与最终用户沟通，按照上一封邮件的说明操作后，是否可以正常安装edge浏览器？
如果有任何进展或疑问可以回复此邮件。

====第3封邮件====

发件人：Wei Liang
发送时间：2023-12-20 14:03:06.730000+00:00
邮件内容:
许先生 您好：
感谢您的电话接听。
麻烦您与最终用户沟通，确认是否可以正常安装edge浏览器？
如果有任何进展或疑问可以回复此邮件。

====第4封邮件====

发件人：Wei Liang
发送时间：2023-12-22 16:28:33.170000+00:00
邮件内容:
许先生 您好：
感谢您的电话接听。
麻烦您与最终用户沟通、确认是否可以正常离线安装edge浏览器？
如果有任何进展或疑问可以回复此邮件。

====第5封邮件====

发件人：Wei Liang
发送时间：2023-12-26 16:45:51.483000+00:00
邮件内容:
许先生 您好：
感谢您的电话接听。
确认您的问题已经解决，我将归档此案例。
工单的归档并不会影响我们为您提供技术支持服务，如有其他问题，您可以随时联系我们。
案例总结：
----
问题定义：
工行反馈用户杨金妹的设备离线安装edge浏览器失败，需要协助排查。
问题总结：
edge浏览器安装包会检查操作系统版本，如果不符合安装要求，会提示先安装操作系统更新补丁。而用户设备由于系统组件损坏，安装系统更新补丁失败，最终通过添加注册表键值Allowsxs，跳过系统版本更新检查，成功安装edge浏览器。
建议操作：
edge浏览器安装包会检查操作系统版本，如果不符合安装要求，会提示先安装操作系统更新补丁。可以按照以下操作添加注册表，尝试跳过系统版本检查，安装edge浏览器。
1）以管理员权限打开cmd命令行，通过以下命令添加Allowsxs注册表键值。
reg add HKLM\SOFTWARE\Policies\Microsoft\EdgeUpdate /v Allowsxs /t REG_DWORD /d 1 /f
2）再次测试是否可以正常离线安装edge浏览器。
针对系统组件存储库损坏导致更新补丁KB5032196安装失败的问题，请尝试以下操作修复系统组件。
1）找一台成功安装了KB5032196的设备，将C:\Windows共享。
2）确保可以通过\\xxx.xxx.xxx.xxx\windows的方式访问到Windows <file://xxx.xxx.xxx.xxx/windows的方式访问到Windows> 源，以管理员权限打开cmd命令行，运行如下命令尝试修复： 
Dism /Online /Cleanup-Image /RestoreHealth /Source:\\xxx.xxx.xxx.xxx\windows /LimitAccess  （\\xxx.xxx.xxx.xxx\windows指共享访问地址 <file://xxx.xxx.xxx.xxx/windows指共享访问地址> ）
提示：
运行dism命令修复过程中出现0x800f081f属于正常报错。
3）尝试再次安装KB5032196补丁，如果还是安装失败，建议重新安装对应的操作系统或者升级当前的操作系统到V2022-L版本。
以上，如您后续有任何问题，可随时与我们联系，谢谢。
