邮件主题：回复: [案例号: CAS-10324-D0S4D3 ] % |P2|ICBC|工行反馈在V2020-L版本系统脚本运行完毕后输出位置不对 % 初次响应 CMIT:0001437

====第1封邮件====

发件人：Jia Wei
发送时间：2023-11-21 10:51:38.017000+00:00
邮件内容:
许先生，您好
很高兴与您电话沟通，目前在本地纯净环境下可以正常生成C:\Windows\Patch.txt文件。如果需要进一步分析还需要抓取Procmon日志
问题定义: 
反馈V2020-L版本系统脚本wsus.vbs运行完毕后输出位置不对，应该输出到C:\Windows\Patch.txt，但实际输出到C:\Patch.txt
问题范围: 
我们将协助您分析处理上述问题，并对定义的问题给予最大的技术支持。
如果能及时解决问题，或问题属于产品设计的行为，或问题涉及到三方，我们将考虑关闭案例。如果存在多个问题，则我们考虑拆分案例进行分析。
接下来，我们将开始合作解决这个问题。如果您对以上的问题范围界定有任何异议，请尽快告知。如果您有其他任何疑问。也欢迎随时与我联系。
日志收集：
Procmon日志。
1）在问题计算机上，下载解压附件ProcessMonitor.zip。双击Procmon.exe运行，到达此页面，会有有大量条目出现，当前已经开始抓取；
2）复现问题（运行脚本生成Patch.txt）。返回Process Monitor窗口，单击Capture（如下图所示），停止抓取
3）点击File, 点击Save. 选择"All events" and "Native Process Monitor Format (PML)"点击OK。压缩并反馈文件保存位置及问题发送具体时间点（便于定位问题）。 
--------------

====第2封邮件====

发件人：Wei Liang
发送时间：2023-11-22 10:50:41.700000+00:00
邮件内容:
许先生 您好：
查看您提供的wsus.vbs脚本运行的procmon日志，显示这个脚本是通过DSP应用MedTrunk.exe调用的。
MedTrunk.exe是32位应用程序，然后它调用32位应用C:\WINDOWS\SysWOW64\WScript.exe执行wsus.vbs脚本。
wsus.vbs脚本中涉及的注册表路径HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\PathName自动转换为查找32位注册表的路径HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows NT\CurrentVersion\PathName。
而当前问题设备中对应的注册表路径下没有PathName键值，所以就直接在系统盘目录下创建了Patch.txt文件（C:\Patch.txt）。
修改建议：
建议修改wsus.vbs脚本，将WindowsPath变量使用其他方式获取当前系统正确的路径。
如果只有个别设备有问题，可以在问题设备的32位注册表位置HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\Windows NT\CurrentVersion手动增加PathName键值。
以管理员权限执行以下命令：
reg add "HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\Windows NT\CurrentVersion" /v PathName /t reg_sz /d C:\windows /f
也可以与DSP厂商沟通确认是否有64位的DSP应用，能否规避类似问题。

====第3封邮件====

发件人：Wei Liang
发送时间：2023-11-24 15:32:26.193000+00:00
邮件内容:
许先生 您好：
针对wsus脚本运行的procmon日志分析，以及您的要求，对wsus.vbs脚本进行了修改，将WindowsPath变量使用环境变量方式获取当前系统正确的路径。
具体修改情况如下图所示：
请您在您的测试环境中验证修改后的脚本是否可以解决您的问题。
wsus脚本可以通过以下链接下载或者登录CDUC系统从“查看我的文件”页面获取：
https://cduc.cmgos.com/download.php?id=1176&token=TaeFyyQyi2xnW1NUNWi0nypb1pWwth7a

====第4封邮件====

发件人：Jia Wei
发送时间：2023-12-11 14:19:21.892000+00:00
邮件内容:
许先生，您好
根据电话沟通的结果，测试后您可以反馈此邮件
--------------

====第5封邮件====

发件人：Jia Wei
发送时间：2023-12-14 15:33:26.086000+00:00
邮件内容:
许先生，您好
根据之前沟通的结果，我将暂时归档此问题。案例归档后您会收到调查问卷的邮件，希望可以对我们的服务进行评价。
案例总结：
案例描述：
反馈V2020-L版本系统脚本wsus.vbs运行完毕后输出位置不对，应该输出到C:\Windows\Patch.txt，但实际输出到C:\Patch.txt
案例进展：
分析脚本并提供解决方案，沟通后可归档案例。
--------------
