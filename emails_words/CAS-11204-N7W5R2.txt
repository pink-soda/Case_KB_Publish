邮件主题：回复: [案例号: CAS-11204-N7W5R2 ] % |P2|ICBC|工行用户反馈V2020-L版本安装Edge浏览器失败问题 % 初次响应 CMIT:0001418

====第1封邮件====

发件人：Wei Liang
发送时间：2024-04-15 16:39:21.951000+00:00
邮件内容:
许先生 您好：
感谢您的电话接听。
根据您提供的信息，我谨在此阐述我们双方针对这个问题所涉及范围界定：
问题定义:
工行用户反馈有1台设备V2020-L版本安装Edge浏览器失败，需要协助排查。
问题范围:
我们将协助您分析处理上述问题，并对定义的问题给予最大的技术支持。
如果能及时解决问题，或问题属于产品设计的行为，或问题涉及到三方，我们将考虑关闭案例。如果存在多个问题，则我们考虑拆分案例进行分析。
接下来，我们将开始合作解决这个问题。如果您对以上的问题范围界定有任何异议，请尽快告知。如果您有其他任何疑问。也欢迎随时与我联系。
此设备的日志已经收到，正在排查问题，如果有任何进展会及时与您沟通，谢谢。

====第2封邮件====

发件人：Wei Liang
发送时间：2024-04-16 13:57:09.039000+00:00
邮件内容:
许先生 您好：
从您这边获取的信息以及对应的日志分析和本地测试，结合edge浏览器安装包会检查操作系统版本的操作，初步判断是由于当前的V0-H系统版本过低导致edge浏览器无法安装。
建议操作：
将当前的V0-H系统安装其对应的最新的堆栈更新补丁KB4580398和累积更新补丁KB5000809。可以通过内部的WSUS服务器更新补丁，或者通过以下页面访问下载：
KB4580398堆栈更新：https://support.cmgos.com/kb/4580398
KB5000809累积更新：https://support.cmgos.com/kb/5000809
或者升级当前的操作系统版本到V2020-L或V2022-L。
或者按照以下操作添加注册表，尝试跳过系统版本检查，安装edge浏览器。
1）以管理员权限打开cmd命令行，通过以下命令添加Allowsxs注册表键值。
reg add HKLM\SOFTWARE\Policies\Microsoft\EdgeUpdate /v Allowsxs /t REG_DWORD /d 1 /f
2）再次测试是否可以正常离线安装edge浏览器。
详细分析：
查看edge浏览器安装程序报错提示：There is a problem with this Windows Installer package. A program run as part of the setup did not finish as expected. Contact your support personnel or package vendor.  
查看procmon日志未发现明显的错误，检查操作系统版本为V0-H，小版本号为17134.860。
在测试环境中安装V0-H系统，并安装累积更新到对应的17134.860版本，安装edge浏览器复现了同样的问题。
但是安装了V0-H系统的最新的累积更新补丁后，可以正常安装edge浏览器。
结合在其他版本的操作系统上安装edge浏览器会提示需要更新操作系统补丁的提示，建议更新操作系统补丁或者尝试跳过操作系统版本检查。

====第3封邮件====

发件人：Wei Liang
发送时间：2024-04-18 15:57:56.053000+00:00
邮件内容:
许先生 您好：
感谢您的电话接听。
确认您的问题已经解决，我将归档此案例。
工单的归档并不会影响我们为您提供技术支持服务，如有其他问题，您可以随时联系我们。
案例总结：
----
问题定义：
工行用户反馈有1台设备V2020-L版本安装Edge浏览器失败，需要协助排查。
问题总结：
edge浏览器安装包在安装过程中会检查操作系统版本，edge浏览器无法安装是由于当前的V0-H系统版本过低，建议更新操作系统补丁或者尝试跳过操作系统版本检查。
用户通过添加Allowsxs注册表键值，跳过操作系统检查，完成edge浏览器安装。
建议操作：
将当前的V0-H系统安装其对应的最新的堆栈更新补丁KB4580398和累积更新补丁KB5000809。可以通过内部的WSUS服务器更新补丁，或者通过以下页面访问下载：
KB4580398堆栈更新：https://support.cmgos.com/kb/4580398
KB5000809累积更新：https://support.cmgos.com/kb/5000809
或者按照以下操作添加注册表，尝试跳过系统版本检查，安装edge浏览器。
1）以管理员权限打开cmd命令行，通过以下命令添加Allowsxs注册表键值。
reg add HKLM\SOFTWARE\Policies\Microsoft\EdgeUpdate /v Allowsxs /t REG_DWORD /d 1 /f
2）再次测试是否可以正常离线安装edge浏览器。
以上，如您后续有任何问题，可随时与我们联系，谢谢。
