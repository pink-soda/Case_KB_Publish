邮件主题：回复: [案例号: CAS-10743-K7X7R0 ] % |P2|ICBC|工行用户反馈V2020-L版本系统使用ie浏览器无法识别控件 % 初次响应 CMIT:0001424

====第1封邮件====

发件人：Li Qi
发送时间：2024-01-18 10:03:46.282000+00:00
邮件内容:
王先生&毕先生，您好：
如刚才电话沟通，我谨以此封邮件阐述我们双方针对这个问题所涉及范围界定： 
问题定义: 
用户反馈V2020-L使用照片应用进行打印时，出现打印报错的问题，需要协助分析处理。
问题范围: 
我们将协助您分析处理上述问题，并对定义的问题给予最大的技术支持。 
如果能及时解决问题，或问题属于产品设计的行为，或问题涉及到三方，我们将考虑关闭案例。如果存在多个问题，则我们考虑拆分案例进行分析。 
接下来，我们将开始合作解决这个问题。如果您对以上的问题范围界定有任何异议，请尽快告知。如果您有其他任何疑问。也欢迎随时与我联系。 
下一步动作：
请王先生先在行内进行一些问题的复现和背景了解，为后续的日志收取或测试工作做一些准备，明确如下几个事项：
1.	是否存在同一台机器上既能正常打印也会出现打印报错的情况，即切换不同的打印机型号可以复现正常和失败两种情况，如存在，请记录下对应的打印机型号。
2.	是否当前出现该问题的机器都是发生在安装9月累积更新KB5030214之后，即小版本在17763.4851之后。可否找到未安装到该补丁的机器复现是否存在打印问题，如不能，可否卸载累积更新至9月累积更新之前再进行问题复现。
3.	是否方便在问题电脑上临时卸载TMS后复现该问题，仅供测试用。

====第2封邮件====

发件人：Li Qi
发送时间：2024-01-22 17:53:09.359000+00:00
邮件内容:
王先生 & 毕先生，您好：
如刚才电话沟通，请按如下方法确认打印机是否用到UNIDRV.dll，您可参考如下Print Management截图：
具体方法为：按Win+R，在输入框中输入“printmanagement.msc”，点击“打印服务器”-“本地”-“驱动程序”，右键选择右侧列表中打印机的“属性”，查看驱动程序文件，是否为UNIDRV.DLL
如“驱动程序文件”显示为UNIDRV.DLL则目前受2023.7B及后续补丁引起的bug，需要终端用户更改其他应用程序进行打印，或联系打印机厂商询问是否有相对应型号的打印机驱动程序更新。使打印机可以正常应用自身型号驱动程序文件。

====第3封邮件====

发件人：Li Qi
发送时间：2024-01-23 10:22:40.579000+00:00
邮件内容:
王先生 & 毕先生，您好：
       如昨天电话沟通，当前此问题判断为23年7B累积更新导致的功能性bug导致，经您的确认，您已知悉此情况，该问题将做归档处理，以下为案例总结：
Case No：CAS-10743-K7X7R0
问题描述：
=================
反馈V2020-L版本系统安装KB5030214补丁后打印异常，报错代码为：0x80004005。需要协助分析处理
问题分析：
=================
      经日志分析与代码查询，发现自23年7B的累积更新安装之后，当使用unidrv关联打印驱动做图片预览时，处理逻辑进行了优化，这一优化导致BindPrinter绘图预览时检测到CreateDC失败进而导致异常，这是发生当前问题的根本原因，安装后续补丁也会优化该处理逻辑。该问题属于累积更新补丁带来的功能性bug，受影响范围包括：基于1809版本的V 2020-L和基于21H2版本的V2022-L。
针对此问题，目前可供您参考的处理方法有两种：
1.	不使用照片应用进行图片打印。
2.	联系打印机厂商更新打印机驱动或更换打印机，不使用unidrv.dll作为打印驱动程序文件的打印机进行照片应用内的打印。作为参考，您可以使用如下方法确认当前打印机所使用的驱动程序文件。
具体方法为：按Win+R，在输入框中输入“printmanagement.msc”，点击“打印服务器”-“本地”-“驱动程序”，右键选择右侧列表中打印机的“属性”，查看驱动程序文件，是否为UNIDRV.DLL
案例总结：
=================
经用户确认，用户已知悉上述情况。经用户同意，该case将做归档处理，如有其他问题，可随时联系我们，谢谢。
