邮件主题：回复: [案例号: CAS-05277-R8L0N2 ] % CMGE3.2激活客户端安装报错 % 初次响应 CMIT:0001504

====第1封邮件====

发件人：Wei Liang
发送时间：2021-12-08 15:53:44.392000+00:00
邮件内容:
Hi Mingyuan：
根据您提供的信息，我谨在此阐述我们双方针对这个问题所涉及范围界定：
问题定义:
安装3.2.7.1025版本激活客户端报错：“Windows Installer程序包有问题。此安装需要的脚本不能运行。请与你的支持人员或程序包开发商联系。”
问题范围:
我们将协助您分析处理上述问题，并对定义的问题给予最大的技术支持。
如果能及时解决问题，或问题属于产品设计的行为，或问题涉及到三方，我们将考虑关闭案例。如果存在多个问题，则我们考虑拆分案例进行分析。
接下来，我们将开始合作解决这个问题。如果您对以上的问题范围界定有任何异议，请尽快告知。如果您有其他任何疑问。也欢迎随时与我联系。
1、查看系统应用日志，提示MsiInstaller错误：
2、查看procmon日志中关于激活客户端可能的脚本信息，激活客户端在安装过程中会释放upgradetask.vbs脚本。
3、查看此脚本的行13，列1的具体内容：
4、这一行在定义获取WMI相关对象，而且日志收集工具中也有很多命令通过查询WMI数据获取的信息为空。
基于这些信息，判断激活客户端安装失败与计算机的WMI问题相关。
请您运行一个简单的wmic命令去访问WMI数据库，查看其能否正常运行。如以下wmic命令查询本机UUID。
wmic csproduct get uuid
如报错，请记录其具体报错信息截图。
您可以按照以下文章尝试验证并修复WMI数据库，如验证WMI数据库一致，那我们将进一步排查此问题。
http://10.0.37.115:8090/pages/viewpage.action?pageId=38774966

====第2封邮件====

发件人：Wei Liang
发送时间：2021-12-15 10:49:05.226000+00:00
邮件内容:
Hi Mingyuan：
确认您的问题已经解决，我将归档此案例。
工单的归档并不会影响我们为您提供技术支持服务，如您有其他问题，您可以致电技术支持热线4008180055。
案例总结：
----
问题定义：
安装3.2.7.1025版本激活客户端报错：“Windows Installer程序包有问题。此安装需要的脚本不能运行。请与你的支持人员或程序包开发商联系。”
问题总结：
分析确认此问题与本机的WMI组件无法查询相关信息有关，重建WMI数据库，WMI组件正常运行后，可以正常安装新版激活客户端。
处理方法：
新版激活客户端的自定义脚本需要通过WMI查询相关信息，由于本机WMI组件出现问题导致脚本运行出错，激活客户端安装失败。
可以采用重建WMI数据库的方法修复WMI组件相关问题，具体操作如下：
1、运行services.msc打开服务管理界面，停止Windows Management Instrumentation服务（Winmgmt）并设置为禁用。
2、需要管理员权限重命名C:\Windows\System32\wbem\Repository文件夹和C:\Windows\SysWOW64\wbem\Repository文件夹。
3、设置Windows Management Instrumentation服务（Winmgmt）为自动，并启动此服务。
4、确认Windows Management Instrumentation正常运行后，运行wbemtest.exe验证WMI组件正常运行。
以上，如您后续有任何问题，可随时与我们联系，谢谢。
