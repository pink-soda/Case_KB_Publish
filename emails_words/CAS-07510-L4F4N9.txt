邮件主题：回复: [案例号: CAS-07510-L4F4N9 ] % |P2|ICBC|反馈宁波分行用户鼠标图标问题 % 初次响应 CMIT:0001948

====第1封邮件====

发件人：Wei Liang
发送时间：2022-11-04 14:30:16.566000+00:00
邮件内容:
熊先生 您好：
感谢您的电话接听。
根据您提供的信息，我谨在此阐述我们双方针对这个问题所涉及范围界定：
问题定义:
宁波分行用户反馈有设备的鼠标指针右边一直有圆圈图标显示，需要协助排查是什么原因。
问题范围:
我们将协助您分析处理上述问题，并对定义的问题给予最大的技术支持。
如果能及时解决问题，或问题属于产品设计的行为，或问题涉及到三方，我们将考虑关闭案例。如果存在多个问题，则我们考虑拆分案例进行分析。
接下来，我们将开始合作解决这个问题。如果您对以上的问题范围界定有任何异议，请尽快告知。如果您有其他任何疑问。也欢迎随时与我联系。
排查建议：
从以下链接下载收集日志所需的工具：
https://cduc.cmgos.com/download.php?id=733&token=8vCL7U8G5hz8g9YaArusZo3K4CTlQ5RT
1）请确认设备上的鼠标属性配置情况，打开“控制面板”-“硬件和声音”类别中的“鼠标”项。
2）确认 鼠标属性 的 指针 图标显示情况默认如下图所示。从此图中可以知道鼠标带圆圈图标表示后台运行。
3）打开任务管理器，切换到详细信息页面，注意观察是否有哪个应用的PID值在一直变化或者一直在新建应用进程，如果存在，将此应用强制结束或者卸载后，观察鼠标指针是否恢复正常。
4）如果未发现异常的进程活动，按照以下操作收集procmon日志和wpr日志和相关系统日志。
a.  运行procmon.exe，点击accept后，到达如下图的界面：（图标1不带x表示处于抓取状态）
b.  在鼠标出现圆圈图标显示后，等待20秒钟左右，点击图标1停止抓取（停止抓取后图标1带x），点击““File”-“save”，选择all events保存pml文件，将此文件压缩后上传。
c.  打开wpr工具，运行wprui.exe，出现热键提示时点击确定，在wprui配置界面，按照下图所示配置，即勾选“First level triage”、“CPU usage”、“File I/O activity”、 “Registry I/O activity”、“Handle usage”、“Minifilter I/O activity”后，配置Performance scenario 为General。
d.  配置完成后，点击“Start”开始抓取wpr日志，鼠标出现圆圈图标显示后，等待20秒钟（Time显示持续时间）
e.  点击Save保存wpr日志，在File Name指定保存位置，点击Save，将保存的etl日志压缩后上传。
f.  在设备上运行CMGELogCollectorV2.exe，勾选全部选项，点击“收集”，运行几分钟后会在桌面生成日志压缩包，将此压缩包上传。
日志上传方法：
您可以登陆https://cduc.cmgos.com <https://cduc.cmgos.com/> ，通过数据上传系统上传您所收集的日志信息。
用户名：icbcsupport
密码：icbcsupport
注意：添加文件，点击上传后，跳转到新的页面点击保存。

====第2封邮件====

发件人：Wei Liang
发送时间：2022-11-04 17:25:08.559000+00:00
邮件内容:
熊先生 您好：
您发送的鼠标图标问题的邮件已经收到，正在下载相关日志，有任何进展会及时与您联系沟通。

====第3封邮件====

发件人：Wei Liang
发送时间：2022-11-04 18:23:48.885000+00:00
邮件内容:
许先生 您好：
感谢您的电话接听。
查看抓取的procmon日志，发现checkhosts2.exe与pcit.exe一直在不停地启动退出，checkhosts2.exe是由计划任务执行的，怀疑鼠标图标问题与此有关。
经了解，checkhosts2.exe在计划任务中是检测到“安全”事件日志中出现eventID 4663 后，会触发此任务。查看“安全”事件日志，发现一直在生成4663日志记录，导致了cheskhost2.exe一直重复启动退出。
4663是在访问C:\Windows\System32\drivers\etc\hosts文件时产生的审核日志。
下一步建议：
排查出问题的设备上的hosts文件审核配置情况，与未出现问题的设备上的审核配置对比有什么区别，查看文件审核配置如图所示：
1）查看hosts文件的“属性”，在“安全”页选择“高级”。
2）在打开的页面中选择“审核”，查看具体的配置情况，注意要打开具体的审核项目并选择“高级权限”查看具体配置。

====第4封邮件====

发件人：Wei Liang
发送时间：2022-11-07 10:13:07.408000+00:00
邮件内容:
许先生 您好：
感谢您的电话接听。
再次对比查看hosts文件相关的组策略对比设置，此组策略名称为： PO-ICBC-HostFileMonitorPolicy
出现问题的设备的组策略配置：
未配置checkhosts2.exe应用前的组策略配置：
您这边可以测试checkhosts2.exe反复运行是否与hosts文件的审核配置有关。

====第5封邮件====

发件人：Wei Liang
发送时间：2022-11-07 10:39:09.921000+00:00
邮件内容:
许先生 您好：
感谢您的电话接听。
经了解，checkhosts2.exe在计划任务中配置了检测到“安全”事件日志中出现eventID 4663 后，触发此任务。
查看“安全”事件日志，发现一直在生成4663日志记录，导致了checkhosts2.exe一直重复启动退出。
4663是在访问C:\Windows\System32\drivers\etc\hosts文件时产生的审核日志。
checkhosts2.exe封装了vbs脚本，它运行时会调用wscript.exe，事件日志显示此时的4663事件是读取（ReadData）hosts文件产生的。
查看hosts文件的具体审核配置情况（PO-ICBC-HostFileMonitorPolicy）：
确实开启了“读取和执行”审核配置，这使得checkhosts2.exe运行时生成4663事件，而计划任务发现有4663事件，会触发再次执行checkhosts2.exe，导致checkhosts2.exe循环启动。
对比以前checkhosts.exe的计划任务对hosts文件的审核配置如下：
您可以在测试环境中按照用户环境配置hosts文件审核，验证是否复现问题，如果关闭“读取和执行”审核策略，是否可以解决问题。

====第6封邮件====

发件人：Wei Liang
发送时间：2022-11-08 11:16:47.068000+00:00
邮件内容:
许先生 您好：
经过您的确认，问题已经解决，我将归档此案例。
工单的归档并不会影响我们为您提供技术支持服务，如您有其他问题，您可以致电技术支持热线4008180055。
案例总结：
----
问题定义：
宁波分行用户反馈有设备的鼠标指针右边一直有圆圈图标显示，需要协助排查是什么原因。
问题总结：
经过排查，确认是针对hosts文件的审核策略变化导致的问题，重新调整相关策略后解决问题，可以归档案例。
问题排查：
在procmon日志中发现checkhosts2.exe进程反复启动停止。
经了解，checkhosts2.exe在计划任务中配置了检测到“安全”事件日志中出现eventID 4663 后，触发此任务。
查看“安全”事件日志，发现一直在生成4663日志记录，导致了checkhosts2.exe一直重复启动退出。
4663是在访问C:\Windows\System32\drivers\etc\hosts文件时产生的审核日志。
checkhosts2.exe封装了vbs脚本，它运行时会调用wscript.exe，事件日志显示此时的4663事件是读取（ReadData）hosts文件产生的。
查看hosts文件的具体审核配置情况（PO-ICBC-HostFileMonitorPolicy）：
开启了“读取和执行”审核配置，这使得checkhosts2.exe运行时生成4663事件，而计划任务发现有4663事件，会触发再次执行checkhosts2.exe，导致checkhosts2.exe循环启动。
对比以前checkhosts.exe的计划任务对hosts文件的审核配置如下：
在测试环境中按照用户环境配置hosts文件审核，验证是否复现问题，如果关闭“读取和执行”审核策略，是否可以解决问题。
以上，如您后续有任何问题，可随时与我们联系，谢谢。
