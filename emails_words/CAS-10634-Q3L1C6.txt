邮件主题：回复: [案例号: CAS-10634-Q3L1C6 ] % 售前-兴业银行云桌面问题 % 初次响应 CMIT:0001202

====第1封邮件====

发件人：Wei Liang
发送时间：2024-01-03 11:46:34.979000+00:00
邮件内容:
许先生 您好：
感谢您的电话接听。
根据您提供的信息，我谨在此阐述我们双方针对这个问题所涉及范围界定：
问题定义:
兴业银行用户反馈在华为桌面云FusionAccess场景下，有两台安装了V2022-L系统的虚拟机在使用过程中卡死，重启后可以正常使用，需要协助排查。
问题范围:
我们将协助您分析处理上述问题，并对定义的问题给予最大的技术支持。
如果能及时解决问题，或问题属于产品设计的行为，或问题涉及到三方，我们将考虑关闭案例。如果存在多个问题，则我们考虑拆分案例进行分析。
接下来，我们将开始合作解决这个问题。如果您对以上的问题范围界定有任何异议，请尽快告知。如果您有其他任何疑问。也欢迎随时与我联系。
针对操作系统在使用中卡死的情况，此时操作系统是无法记录相关日志的，重启后操作系统日志中也没有相关问题记录。
要排查此类系统卡死问题，只能先为操作系统配置好手动生成内存转储操作，在复现卡死问题时，通过键盘或者NMI功能触发蓝屏，获取当前卡死状态下的dump文件，通过此dump文件分析可能的卡死原因。
对于在虚拟化平台中的虚拟机出现卡死问题，无法使用键盘触发蓝屏，需要虚拟化平台厂商使用其NMI功能生成dump文件。
您当前的虚拟机暂未复现卡死问题，您可以先按照以下操作进行配置，如果再次出现卡死问题，可以请虚拟化平台厂商进行NMI操作或指导，获取出现问题时的dump文件进行分析。
1）在安装了V2022-L系统的虚拟机中，以管理员权限打开cmd命令行，通过执行以下命令添加crashdump注册表配置项：
reg add HKLM\SYSTEM\CurrentControlSet\Control\CrashControl /v AlwaysKeepMemoryDump /t REG_DWORD /d 0x1 /f
reg add HKLM\SYSTEM\CurrentControlSet\Control\CrashControl /v Overwrite /t REG_DWORD /d 0x1 /f
reg add HKLM\SYSTEM\CurrentControlSet\Control\CrashControl /v CrashDumpEnabled /t REG_DWORD /d 0x1 /f
reg add HKLM\SYSTEM\CurrentControlSet\Control\CrashControl /v NMICrashDump /t REG_DWORD /d 0x1 /f
2）重启虚拟机使dump配置生效。
3）再次出现卡死问题时，请虚拟化平台厂商进行NMI操作或指导，手动触发虚拟机系统蓝屏生成dump文件。
4）当内存转储进度达到100%完成，重启虚拟机，在虚拟机系统中获取dump文件，默认文件路径为：C:\windows\memory.dmp
5）将此dmp文件压缩后提供给神州网信进一步分析。

====第2封邮件====

发件人：Wei Liang
发送时间：2024-01-05 15:19:35.156000+00:00
邮件内容:
许先生 您好：
感谢您的电话接听。
近期未再出现虚拟机使用过程中卡死的问题，经过您的同意，我将暂时归档此案例。
工单的归档并不会影响我们为您提供技术支持服务，如有其他问题，您可以随时联系我们。
案例总结：
----
问题定义：
兴业银行用户反馈在华为桌面云FusionAccess场景下，有两台安装了V2022-L系统的虚拟机在使用过程中卡死，重启后可以正常使用，需要协助排查。
问题总结：
近期未再出现虚拟机使用过程中卡死的问题，暂时归档案例。
如果在虚拟化平台中的虚拟机出现卡死问题，因为无法使用键盘触发蓝屏，需要虚拟化平台厂商使用其NMI功能生成dump文件进一步排查。
操作配置：
请先在虚拟机中按照以下操作进行配置，如果再次出现虚拟机卡死问题，可以请虚拟化平台厂商进行NMI操作或指导，获取出现问题时的dump文件进行分析。
1）在安装了V2022-L系统的虚拟机中，以管理员权限打开cmd命令行，通过执行以下命令添加crashdump注册表配置项：
reg add HKLM\SYSTEM\CurrentControlSet\Control\CrashControl /v AlwaysKeepMemoryDump /t REG_DWORD /d 0x1 /f
reg add HKLM\SYSTEM\CurrentControlSet\Control\CrashControl /v Overwrite /t REG_DWORD /d 0x1 /f
reg add HKLM\SYSTEM\CurrentControlSet\Control\CrashControl /v CrashDumpEnabled /t REG_DWORD /d 0x1 /f
reg add HKLM\SYSTEM\CurrentControlSet\Control\CrashControl /v NMICrashDump /t REG_DWORD /d 0x1 /f
2）重启虚拟机使dump配置生效。
3）再次出现卡死问题时，请虚拟化平台厂商进行NMI操作或指导，手动触发虚拟机系统蓝屏生成dump文件。
4）当内存转储进度达到100%完成，重启虚拟机，在虚拟机系统中获取dump文件，默认文件路径为：C:\windows\memory.dmp
以上，如您后续有任何问题，可随时与我们联系，谢谢。
