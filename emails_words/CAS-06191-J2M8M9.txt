邮件主题：回复: 回复：[案例号: CAS-06191-J2M8M9 ] % 交通银行业务软件卡顿问题协助 % 初次响应 CMIT:0001481

====第1封邮件====

发件人：Wei Liang
发送时间：2022-05-09 12:14:10.133000+00:00
邮件内容:
孙先生 您好：
感谢您的电话接听。
根据您提供的信息，我谨在此阐述我们双方针对这个问题所涉及范围界定：
问题定义:
交行在联想开天m639t 、升腾c73-g3设备上使用业务软件走交易时，往下翻看数据531系统会出现卡死的现象，等几十秒或者几分钟才能查看到下边数据。
问题范围:
我们将协助您分析处理上述问题，并对定义的问题给予最大的技术支持。
如果能及时解决问题，或问题属于产品设计的行为，或问题涉及到三方，我们将考虑关闭案例。如果存在多个问题，则我们考虑拆分案例进行分析。
接下来，我们将开始合作解决这个问题。如果您对以上的问题范围界定有任何异议，请尽快告知。如果您有其他任何疑问。也欢迎随时与我联系。
已经了解到的相关信息：
1）执行200条记录查询时应用不卡死，数据量大时会出现应用卡死。
2）此应用为内部开发的应用，涉及到数据交易，在外部无法使用。
3）此应用交易信息涉及到客户信息，无法提供问题视频。
4）此问题已经提交到应用开发部门和硬件设备厂商，暂未得到反馈。
5）如需收集日志发送到外部分析，需要向上申请。
请您在出现问题的设备上按照以下操作收集相关日志：
Procmon日志：
1）下载附件中的Procmon.zip，解压后双击procmon.exe运行，点击Accept后，到达此页面，会有有大量条目出现，先后点击1，2暂停抓取并清除当前条目。当前已经是可抓取状态；
2）点击下图的图标开始抓取。
3）点击交易系统运行，复现应用卡死问题，并等待应用系统恢复正常。
4）此时回到Process Monitor窗口，单击Capture图标，停止抓取；
5）点击File, 点击Save. 选择"All events" and "Native Process Monitor Format (PML)"点击OK。记录文件保存位置； 
6）将PML文件重命名为“应用卡死日志”、打包压缩， 上传到CDUC。
系统日志：
1）下载附件中的CMGELogCollector.zip，解压后运行CMGELogCollector.exe，勾选全部选项，点击“收集”，运行几分钟后会在桌面生成日志压缩包，将日志上传到CDUC。
Procdump日志：
1.	下载procdump.zip；
2.	创建c:\dumps文件夹；
3.	解压procdump.zip后，使用管理员权限打开CMD命令行窗口，定位到procdump.exe所在的文件夹；
4.	执行以下命令尝试收集应用dmp文件：
procdump.exe -h -e -ma -w xxx.exe c:\dumps（xxx.exe请使用您出现卡死问题的应用exe替换)
5.	再运行交易系统，复现卡死问题，观察在c:\dumps文件夹是否生成对应的dmp文件。
日志上传方法：
您可以登陆https://cduc.cmgos.com <https://cduc.cmgos.com/> ，通过数据上传系统上传您所收集的日志信息。
用户名：jiaotong
密码：jiaotong
注意：添加文件，点击上传后，跳转到新的页面点击保存。

====第2封邮件====

发件人：Wei Liang
发送时间：2022-05-11 10:48:59.065000+00:00
邮件内容:
孙先生 您好：
感谢您的电话接听。
如电话中所说，当前应用是在正式环境中使用出现卡顿问题，已经收集了相关日志，并向上申请是否可以外发，当前暂无法提供相关日志。
基于这种情况，您可以按照以下方式简单确认CPU和IO使用：
1）复现业务应用卡顿问题。
2）打开任务管理器，查看进程页，找到对应的应用，查看其CPU、内存、磁盘情况。（图示是hashcalc.exe应用）
3）转到性能页，查看CPU逻辑处理器数量情况。
4）转到详细信息页，查看应用CPU使用情况。
以截图所示的hashcalc.exe应用为例，它出现了无响应的状态，但是CPU和IO占用并不高，查看其详细CPU使用率显示为12%，计算机的逻辑处理器数量为8。
对于一个应用，如果未对多核心进行过相关优化，那同一时间只能使用其中一个核心CPU，但是系统调度不会让应用集中在一个CPU核心上运行，而是让应用在多个CPU核心上切换运行。
而且任务管理器计算的CPU使用率是整体的CPU使用率，那截图所示的hashcalc.exe应用对于单个核心CPU来说其CPU使用率是12%x8=96%，CPU使用率过高，此时应用不能做其他操作，只能等待应用完成对应的功能后，才能进行下一步操作。
请您观察业务应用卡顿时的CPU和IO使用情况。如果是由于CPU或IO占用过高导致的卡顿，那只能请应用开发人员确定出现卡顿时应用的具体操作，进行相关优化解决卡顿问题，或者提升设备性能解决卡顿问题。

====第3封邮件====

发件人：Wei Liang
发送时间：2022-05-12 12:13:11.434000+00:00
邮件内容:
孙先生 您好：
感谢您的电话接听。
根据您的测试，现在问题现象是出现卡顿问题，等待一段时间后可以恢复正常，业务软件功能正常；出现卡顿问题时，业务软件的CPU使用率换算成单核心CPU可以认为是100%，这可以初步判断业务软件卡顿问题是由CPU性能情况导致的，您可以进一步做以下测试：
1）在未出现问题的旧设备上安装相同的CMGE操作系统，并进行相同的操作，观察、记录新旧设备上的业务软件的CPU使用率进行对比。
2）请业务软件开发人员分析业务软件出现卡顿时的具体操作，分析进行相关优化，或者提升设备性能解决卡顿问题。

====第4封邮件====

发件人：Wei Liang
发送时间：2022-05-16 16:30:46.624000+00:00
邮件内容:
孙先生 您好：
感谢您的电话接听。
根据您的测试结果，旧设备安装CMGE系统运行业务软件，不会出现卡顿问题。新旧设备的差别在于硬件不同，针对此问题的分析可能会考虑硬件性能。
设备厂家推测有可能是显卡性能不足导致的，并提出使用独立显卡进行测试，麻烦您测试后也告知我们测试结果。
针对应用卡顿问题，我们有如下建议：
1）从操作系统角度，需要更详细的应用运行卡顿时抓取的日志，用于分析应用卡顿的可能原因。
2）请业务软件开发人员分析业务软件出现卡顿时的具体操作，确认问题点，判断应用卡顿的原因。

====第5封邮件====

发件人：Wei Liang
发送时间：2022-05-18 15:19:06.462000+00:00
邮件内容:
孙先生 您好：
感谢您的电话接听。
如电话所说，设备厂商建议更换独立显卡测试业务软件运行情况，麻烦您测试后也告知我们测试结果。
从操作系统角度，需要更详细的应用运行卡顿时抓取的日志，用于分析应用卡顿的可能原因。请您跟进已收集的日志外发审批情况。
如果针对当前案件还有需要我们帮助的地方, 欢迎随时联系我们。

====第6封邮件====

发件人：Wei Liang
发送时间：2022-05-20 14:25:17.144000+00:00
邮件内容:
孙先生 您好：
来信是想咨询当前案件进展状况。当前业务软件卡顿问题，更换独立显卡后的测试情况如何？
如果针对当前案件还有需要我们帮助的地方, 欢迎随时联系我们。

====第7封邮件====

发件人：Wei Liang
发送时间：2022-05-24 17:03:04.584000+00:00
邮件内容:
孙先生 您好：
来信是想咨询当前案件进展状况。当前业务软件卡顿问题，更换独立显卡后的测试情况如何？
如果针对当前案件还有需要我们帮助的地方, 欢迎随时联系我们。

====第8封邮件====

发件人：Wei Liang
发送时间：2022-05-25 11:39:02.900000+00:00
邮件内容:
孙先生 您好：
感谢您的电话接听。
如电话所说，待收到设备厂商提供的独立显卡，并验证使用独立显卡时的业务软件运行情况，麻烦您告知我们测试结果。
关于应用卡顿的可能原因，我们需要更详细的日志进行分析，请您跟进已收集的日志外发审批情况。
如果针对当前案件还有需要我们帮助的地方, 欢迎随时联系我们。

====第9封邮件====

发件人：Wei Liang
发送时间：2022-06-02 15:43:16.285000+00:00
邮件内容:
孙先生 您好：
感谢您的电话接听。经过您的同意，我将暂时归档此案例。
工单的归档并不会影响我们为您提供技术支持服务，如您有其他问题，您可以致电技术支持热线4008180055。
案例总结：
----
问题定义：
交行在联想开天m639t 、升腾c73-g3设备上使用业务软件走交易时，往下翻看数据531系统会出现卡死的现象，等几十秒或者几分钟才能查看到下边数据。
问题总结：
收集的应用详细日志涉及安全合规要求，无法外发。用户正在测试使用独立显卡是否可以改善应用卡顿情况，可以暂时归档案例。
以上，如您后续有任何问题，可随时与我们联系，谢谢。
