邮件主题：回复: [案例号: CAS-11431-B7W6M8 ] % |P2|ICBC|工行用户反馈V2020-L版本系统调用外设失败问题 % 初次响应 CMIT:0001870

====第1封邮件====

发件人：Jia Wei
发送时间：2024-05-24 16:33:30.333000+00:00
邮件内容:
杨女士，您好
很高兴与您电话沟通。基于目前在其他Windows 7机器可以正常调用扫描仪外设，您可以参考建议操作进行问题排查：
问题定义: 
反馈Windows 7版本系统调用外设（扫描仪）失败问题，涉及1-2台电脑，需要协助分析处理。
问题范围: 
我们将协助您分析处理上述问题，并对定义的问题给予最大的技术支持。
如果能及时解决问题，或问题属于产品设计的行为，或问题涉及到三方，我们将考虑关闭案例。如果存在多个问题，则我们考虑拆分案例进行分析。
接下来，我们将开始合作解决这个问题。如果您对以上的问题范围界定有任何异议，请尽快告知。如果您有其他任何疑问。也欢迎随时与我联系。
1.	确认问题计算机上的Win 7版本和正常调用外设设备的计算机Win 7版本是否一致。如果不一致则建议使用同样的操作系统版本
例如是否都是同一版本（企业版？专业版）32位或64位，以及目前的内部版本（Service Pack版本）
同时按下Windows+R，运行winver可以查看
2.	查看安装的Chrome浏览器版本是否一致。如不一致建议在问题机器上，安装可以正常加载外设设备系统上的Chrome版本；
3.	如果上述均保持一致，可以进入Chrome F12，在Console中对比查看两台计算机点击调用外设设备按钮之后，所反馈的报错信息。
--------------

====第2封邮件====

发件人：Jia Wei
发送时间：2024-05-30 17:55:30.369000+00:00
邮件内容:
杨女士，您好
很高兴与您电话沟通。
案例分析：
如之前沟通的结果，目前看到问题过程中有大量pyDeviceService.exe进程被创建出来，其中PID为13512的进程在日志收集过程中终止了
进程退出过程中有tmevtmgr.sys filter driver文件介入，此文件应该是TrendMicro开发，趋势反病毒软件相关组件。
此外还有dsmusbencr.sys文件也在过程中大量出现。对应的是华为DSM，时间戳看也很久没有更新过了。
建议操作：
目前从系统层面只能从Procmon日志中检索可疑的三方组件，并采用排除法卸载对应的应用。
建议逐一卸载，确认问题是否解决
*   趋势反病毒软件
*   DSM
日志收集：
同时可以按照附件《Full dump配置方法》配置Full dump，再以管理员身份运行cmd，依次运行如下命令配置注册表键值
reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\Windows Error Reporting\LocalDumps" /v DumpCount /t REG_DWORD /d 10 /f
reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\Windows Error Reporting\LocalDumps" /v DumpFolder /t REG_EXPAND_SZ /d %LOCALAPPDATA%\CrashDumps /f
reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\Windows Error Reporting\LocalDumps" /v DumpType /t REG_DWORD /d 2 /f
配置完毕之后，复现问题现象，如果过程中出现进程崩溃“1000”的事件日志，就会在%LOCALAPPDATA%\CrashDumps目录下生成dmp日志，将日志反馈。
--------------

====第3封邮件====

发件人：Wei Liang
发送时间：2024-06-07 17:22:07.928000+00:00
邮件内容:
杨女士 您好：
根据您提供的信息，在调用外设时，会拉起eapbrowser模块，此模块需要java虚拟机运行。
对比您提供的出现调用外设异常和调用正常的procmon日志，可以看到：
异常日志在读取java虚拟机运行环境时未正常读取java虚拟机的多个模块，期间还有DSP应用的参与。
而正常日志显示访问了java虚拟机的模块，后续继续访问了eapbrowser.jar模块以及eap的页面。
测试建议：
1）请您先在问题设备上确认CsspDeviceServer自带的java虚拟机运行环境是否正常，请您在问题设备上测试其java虚拟机运行环境。
是否可以在问题设备上直接测试自带的java虚拟机运行eapbrowser.jar模块。
java虚拟机运行环境路径：D:\ICBC\CsspDeviceServer\lib_diy\windows\jdk1.8win32\jre\
2）确认其他的Win7 系统安装了DSP应用的设备是否可以正常调用外设，或者测试卸载DSP应用，排除DSP应用的影响。

====第4封邮件====

发件人：Jia Wei
发送时间：2024-06-13 13:42:45.043000+00:00
邮件内容:
杨女士 您好：
来信是跟踪当前案例的进展
如果您有疑问或反馈，可以回复此邮件。
--------------

====第5封邮件====

发件人：Jia Wei
发送时间：2024-06-17 10:36:20.192000+00:00
邮件内容:
杨女士，您好
很高兴与您沟通，根据目前的案例情况，我将暂时归档此问题。案例归档后您会收到调查问卷的邮件，希望可以对我们的服务进行评价。
案例总结：
案例描述：
反馈Windows 7版本系统调用外设（扫描仪）失败问题，涉及1-2台电脑，需要协助分析处理。 
案例进展：
读取java虚拟机运行环境时未正常读取java虚拟机的多个模块。
由于从操作系统层面只能看到进程信息，对于未能正常读取java模块的过程无法查看到更为细节的内容。
建议确认java虚拟机运行环境，再测试卸载DSP应用，排除DSP应用的影响。
--------------
